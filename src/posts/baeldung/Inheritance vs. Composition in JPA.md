---
date: 2024-06-16
category:
  - JPA
  - 数据库
tag:
  - 继承
  - 组合
---
# JPA中的继承与组合

## 1. 引言

继承和组合是面向对象编程（OOP）中的两个基本概念，我们同样可以在JPA中利用它们进行数据建模。在JPA中，继承和组合都是用于建模实体之间关系的技术，但它们代表了不同类型的关系。在本教程中，我们将探讨这两种方法及其含义。

## 2.1. 单表继承（STI）

单表继承（STI）涉及将所有子类映射到单个数据库表中。通过使用鉴别器列来区分子类实例，这简化了模式管理和查询执行。

我们首先使用@Entity注解定义_Employee_实体类作为超类。接下来，我们将继承策略设置为InheritanceType.SINGLE_TABLE，以便将所有子类映射到同一个数据库表。

然后，我们使用@DiscriminatorColumn注解来指定_Employee_类中的鉴别器列。此列用于区分单表中的不同类型实体。

## 2.2. 连接表继承（JTI）

另一方面，连接表继承（JTI）将子类拆分到它们各自的表中。每个子类都有自己的表来存储其独特的详细信息。此外，还有一个表来保存所有子类共有的共享信息。

## 2.3. 类表继承（TPC）

当使用JPA中的类表继承（TPC）策略时，继承层次结构中的每个类都对应其专用的数据库表。因此，我们会看到为每个类：_Shape_、_Square_和_Circle_创建了单独的表。这与JTI不同，后者每个子类有自己的表来存储其独特细节，共享属性存储在连接表中。

## 3. JPA中的组合

组合表示一个“拥有-a”关系，其中一个对象包含另一个对象作为其组件部分。在JPA中，组合通常使用实体关系实现，例如一对一、一对多或多对多关联。

### 3.1. 一对一组合

在一对一组合关系中，一个实体包含另一个实体的一个实例作为其组件部分。这通常使用拥有实体表中的外键来引用关联实体的主键来建模。

### 3.2. 一对多组合

在一对多组合关系中，一个实体包含另一个实体的实例集合作为其部分。这通常使用“多”端实体表中的外键来引用“一”端实体的主键来建模。

### 3.3. 多对多组合

在多对多组合关系中，双方的实体都包含对方实体的实例集合作为其组件部分。这通常使用数据库中的连接表来表示实体之间的关联。

## 4. 总结

这个表格突出了继承和组合之间的主要区别，包括它们的关系性质、代码可重用性、灵活性和耦合度：

| 方面 | 继承 | 组合 |
| --- | --- | --- |
| 关系性质 | 表示一个“是一个”关系。 | 表示一个“拥有一个”关系。 |
| 代码可重用性 | 在层次结构内促进代码重用。子类从超类继承行为和属性。 | 组件可以在不同的上下文中重用，没有继承中固有的紧密耦合。 |
| 灵活性 | 更改超类可能会影响所有子类，可能导致级联变化。 | 个别组件的更改不会影响包含对象。 |
| 耦合度 | 类之间的紧密耦合。子类与超类的实现细节紧密绑定。 | 更松散的耦合。组件与包含对象解耦，减少了依赖。 |

## 5. 结论

在本文中，我们探讨了JPA实体建模中继承和组合之间的基本差异。

继承提供了代码可重用性和清晰的层次结构，适用于子类共享共同行为和属性的场景。另一方面，组合提供了更大的灵活性和适应性，允许动态对象组装和减少组件之间的依赖。